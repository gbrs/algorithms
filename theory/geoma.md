# Геометрия

## Векторы
Сумма векторов: (ax, ay) + (bx, by) = (ax + bx, ay + by)  
Скалярное произведение: (ax, ay) * (bx, by) = ax·bx + ay·by = |a| * |b| * cosA  
Модуль векторного произведения — площадь параллелограмма, считаем через матрицу:  
|(ax, ay) х (bx, by)| = |ax ay| = ax·by - ay·bx = |a|·|b|·sinA  
                        |bx by|  

Вектор перпендикулярный вектору (x, y) — это вектор (-y, x). Используем скалярное произведение.    

Точками AB задана прямая, пересекает ли ее отрезок CD? 
Смотрим разный ли знак у произведений ABxAC и ABxAD.  

Принадлежит ли точка D углу AOB? 2 способа:
1) AD не пересекает прямую OB + BD не пересекает прямую OA;
2) OAxOD и OAxOB имеют один знак.

Принадлежит ли точка треугольнику? 
Достаточно проверить принадлежность точки любым двум углам треугольника.  

tgA = |a x b| / a·b = |a|·|b|·sinA / (|a|·|b|·cosA) = sinA / cosA = tgA  
atan2(y, x) => atan2(модуль векторного произведения, скалярное произведение). 
Вернет результат (-pi; pi] в отличие от atan, возвращающего [-pi/2; pi/2].  

Уравнение прямой на плоскости: ax + by + c = 0. Вектор (a, b) - перпендикуляр к прямой.  

Принадлежит ли точка C прямой AB? 2 варианта:
1) AB x AC == 0;
2) Через уравнение прямой:
    - находим перпендикуляр к вектору AB, получая a и b для уравнения прямой на плоскости;
    - находим c из уравнения прямой, подставив точку A, например;
    - проверяем, что точка C подходит к получившемуся уравнению прямой.

Заданы 2 прямые:  
Ax + By + C = 0  
Dx + Ey + F = 0  
Просто выражаем игрики, приравниваем, получаем выражение для икса. 
Точно так же для игрека?  
Если A, B, D, E не нулевые (?), то решение есть всегда, кроме случаев когда прямые параллельны. 
В знаменателе выражений и будет, фактически, стоять векторное произведение.  


## Расстояние

Расстояние от точки (x0, y0) до прямой: |Ax0 + By0 + C| / sqrt(A^2 + B^2). 
Как-то выводится из того, что (A, B) - перпендикуляр к прямой?  

Расстояние от точки A до луча, начинающегося в B. Если точка "над" лучом, то задача сводится к предыдущей. 
Если нет, то это расстояние между двумя точками. 
Первое или второе мы узнаем по знаку скалярного произведения вектора луча и вектора BA.    

Расстояние от точки A до отрезка BC. 
Можно, например, свести к предыдущей. Дважды находим ответ: для луча BC и CB. И выбираем максимум. 
Наверное, можно скалярными произведениями понять, что точка не "над" отрезком и заифать?   

Расстояния от отрезка AB до отрезка CD: 
1) проверка пересекаются ли. Для всех четырех точек посмотреть, что точки другого отрезка находятся по разные стороны? 
Например, для точки A, что AC x AB и AB x AD не имеют одного знака (0 - подходит - касаются кончиком);  
2) Далее измерять расстояние от всех четырех точек до другого отрезка.


## Многоугольники
Простой - нет точек самопересчечения.

### Площадь
Площадь треугольника ABC через векторное произведение двух векторов: V= (B − A) × (C − A) / 2.  
Многоугольник без самопересечений задан последовательностью вершин в порядке обхода, можно поступить так. 
Пройдемся по всем ребрам и для каждого добавим в общую сумму площадь (со знаком) треугольника, 
заданного этим ребром и началом координат. Вернем сумму по модулю.  
Также существует возможно более интуитивный, но и более громоздкий метод трапеций.  

### Принадлежность точки многоугольнику
Находится ли точка P в треугольнике ABC, заданном против часовой стрелки. 
Тогда она должна лежать слева от всех трёх отрезков AB, BC и CA. 
Система трех неравенств:  
(B−A) × (P−A) ≥ 0  
(C−B) × (P−B) ≥ 0  
(A−C) × (P−C) ≥ 0  
Для выпуклых многоугольников так же. 
Проверка выпуклости многоугольника: для всех последовательных точек a, b, c проверить, что (b − a) × (c − a) > 0.

#### Произвольный многоугольник
Вариант 1. Пройдемся по всем вершинам в порядке обхода и будем последовательно рассматривать углы 
с вершиной в точке P и лучами, проходящими через соседние вершины многоугольника. 
Если просуммировать эти ориентированные углы, то получится какая-то величина θ. 
Если точка P лежит внутри многоугольника, то θ = ±2π, иначе θ = 0.  
Вариант 2. Считаем сколько раз луч, выпущенный из P, пересекает ребра многоугольника. 
Для точки, находящейся внутри, это число будет нечетным, в противном случае — четным (в т.ч. 0?). 
Чтобы не обрабатывать отдельно случаи, когда луч пересекает вершину бросим луч случайным образом, 
надеясь, что так не повезти, нам не может.

## Перегрузка операторов
Удобно не формулы таскать везде, а написать функцию или перегрузить операторы: 
int operator^(r a, r b) { return a.x*b.y - b.x*a.y; }  
Для точек и отрезков удобно создавать свои struct.  

https://ru.algorithmica.org/cs/geometry-basic/segments/
